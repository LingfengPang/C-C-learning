# 计算机网络
## 协议
### 定义
计算机之间通过网络实现通信时事先达成的一种约定

## OSI参考模型
### OSI分层
![OSI分层](images/OSI1.png)
- 7 应用层
为程序提供服务并规定应用程序中通信的相关细节，包括文件传输，电子邮件，远程登陆
- 6 表示层
将应用层信息转化为合适的网络传输格式，或者将下一层的数据转化为上层能够处理的格式
- 5 会话层
负责建立和断开通信连接，以及数据的分割等数据传输相关的管理
- 4 传输层
起着可靠的传输作用，只在通信双方节点上进行处理，而无需再路由器上进行处理
- 3 网络层
将数据传输到目标地址。目标地址可以是多个网络通过路由器连接而成的某一个地址。因此这一层主要负责寻址和路由选择。
- 2 数据链路层
负责物理层面上互连的、节点之间的通信传输。例如与1个以太网相连的2个节点之间的通信。
将0、1序列划分为具有意义的数据帧传送给对端（数据帧的生成与接收）。
- 1 物理层
负责0、1比特流（0、1序列）与电压的高低、光的闪灭之间的互换。

## 传输方式
### 面向有连接与面向无连接
- 面向有连接:在发送数据前，需要在首发主机之间连接一条通信线路，例如打电话
- 面向无连接：不要求建立和断开连接，可以自由发送数据，同时，自己也不知道何时收到数据，接收端需要确认是否收到数据。例如邮局发包裹
### 电路交换与分组交换
- 电路交换：两条电路、最多只能有两个用户同时通信。交换机主要负责数据的中转处理。建立好连接以后，用户就可以一直使用这条电路，直到该连接被断开为止
- 分组交换：1条通信线路(线路共享)、通过线路共享可以让3个用户同时通信。让连接到通信电路的计算机将所要发送的数据分成多个数据包，按照一定的顺序排列之后分别发送。分组交换的大致过程是：发送端计算机将数据分组发送给路由器，路由器收到这些分组以后，缓存到自己的缓冲区，然后再转发给目标计算机。路由器接收到数据以后会按照顺序缓存到相应的队列当中，再以先进先出的顺序将它们逐一发送出去。
### 根据接收端数量分类、
- 单播：1对1通信，如电话
- 广播：1对多
- 多播：1对指定的多
- 任播：组内任意一台作为接收机

## 地址
- 1.唯一性
- 2.层次性：例如IP地址由网络号和主机号决定

## 网络构成要素
- 1.通信媒介和数据链路：以太网，电缆等
- 2.网卡：是计算机连网的设备
- 3.中继器：从物理层上延长网络的设备，如Hub
- 4.网桥/2层交换机：从数据链路层上延长网络的设备
- 5.路由器/3层交换机：连接网络与网络的设备，将分组报文发送给另一个目标路由器，可以连接任意两个数据链路层。
对应OSI模型第3层
- 6.4~7层路由器(负责均衡器)：负责处理OSI模型中从传输层到应用层的数据，向多个服务器分散压力
- 7.网关：负责协议的转化和数据的转发，是OSI模型中负责传输层到应用层的数据进行转化和转发的设备

## TCP/IP分层
- 物理层（硬件）:负责数据传输，如网线
- 数据链路层（网络接口层）：相当于驱动程序，操作系统与硬件的桥梁
- 网络层（互联网层）：使用IP协议
- 传输层：实现应用程序间通信
- 应用层（会话层以上的分层）：

## 数据链路层
数据链路层的协议定义了通过通信媒介互连的设备之间的传输规范
### 数据链路层的技术
- MAC地址：用于识别数据链路层中互连的节点
![MAC地址](images/mac.png)
### 共享介质网络
- 争用方式CSMA：先到先得的方式占用信道发送数据，有可能发生冲突
- 令牌传递方式：只有获得令牌才能发送
### 非共享介质网络
网络中每个站直连交换机
### 根据MAC地址转发
交换机发送数据包时能够记忆MAC地址，下次发送时直接通过那个端口直接发送
### 环路检测技术
- 生成树方式：网桥为根，对每个端口设置权重。通过检查网络结构禁止某些端口的使用。
- 源路由法：判断发送数据的源地址通过哪个网桥传输输线的。
### VLAN
同一个交换机分成了不同的网段

## 以太网
### 以太网帧格式
-（1）前导码：前导码位于以太网帧前端8字节，最后一个字节末尾为“11”。以太网定义最后的两个比特即”11“为SFD，IEEE802.3以太网定义最后的整个字节为SFD
-（2）以太网帧本体：以太网首部14字节（目标MAC地址6字节，源MAC地址6字节，上层协议类型2字节），数据（46~1500字节），FCS（4字节）
-（3）IEEE802.3以太网帧体格式：以太网首部22字节（目标MAC地址6字节，源MAC地址6字节，帧长度2字节，LLC 2字节，SNAP 5字节），数据（46~1492字节），FCS（4字节）
（4）数据链路分层：数据链路层分为介质访问控制层LLC和逻辑链路控制层MAC；
介质访问控制层根据以太网或FDDI等不同数据链路所特有的首部信息进行控制；（目标与源MAC地址，前导码，FCS（整个帧除以生成多项式的余数 CRC循环冗余校验码算法）等）
逻辑链路控制层则根据以太网或FDDI等不同数据链路所共有的帧头信息进行控制；（主要是LLC（DSAP 1字节AA，SSAP 1字节AA，CTRL 1字节03）与 SNAP（厂商3字节，类型2字节））



***以太网的帧体格式如下：***
|目标MAC地址(6字节)|源MAC地址（6字节）|	类型（2字节）|数据（46字节-1500字节）|FCS（4字节）|
|  ----   | ----  | ----  | ----  |----  |
***IEEE802.3以太网帧体格式：***
|目标MAC地址(6字节)|	源MAC地址（6字节）|	帧长度（2字节）	|LLC（3字节）|	SNAP(5字节)	|数据（38-1492字节）|	FCS（4字节）|
|  ----   | ----  | ----  | ----  |----  |----  |----  |